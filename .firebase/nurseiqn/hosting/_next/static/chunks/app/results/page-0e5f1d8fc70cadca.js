(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[139],{7341:(e,t,r)=>{"use strict";r.d(t,{ResultsClient:()=>q});var s=r(95155),l=r(12115),a=r(35695),i=r(74136),n=r(30285),d=r(66695),c=r(83540),o=r(93774),u=r(94754),x=r(96025),h=r(16238),m=r(94517),p=r(20594),f=r(54811),g=r(91467),j=r(8376),v=r(24371),y=r(1978),b=r(49072),w=r(35317),N=r(56104),A=r(59434),k=r(29100);function q(){let e=(0,a.useRouter)(),{topic:t,userAnswers:r,resetQuiz:q,quizDuration:C}=(0,i.f)(),{user:I,updateUserScore:z}=(0,b.A)(),[S,P]=(0,l.useState)(null),[R,E]=(0,l.useState)(!0);(0,l.useMemo)(()=>{if(!t||!I)return void E(!1);let e=0,s=0,l=0,a=t.questions.map((t,a)=>{let i=r[a],n=i===t.correctIndex;return n?(e++,s++):l++,{questionId:t.id,question:t.text,isCorrect:n,options:t.options,correctIndex:t.correctIndex,userAnswerIndex:i,correctAnswer:t.options[t.correctIndex],userAnswer:null!=i?t.options[i]:null,originalExplanation:t.explanation}}),i=e/t.questions.length*100;P({score:e,percentage:i,accuracy:i,correctAnswers:s,incorrectAnswers:l,breakdown:a}),e>0&&z(10*e);let n=(0,w.H9)(N.db,"users",I.uid,"quizProgress",t.id);(0,w.BN)(n,{completed:!0,score:e,percentage:i},{merge:!0}).catch(()=>{}),E(!1)},[t,r,I,z]),(0,l.useEffect)(()=>{R||t&&I||e.push("/topics")},[R,t,I,e]);let Q=(0,l.useMemo)(()=>S?[{name:"Correct",value:S.correctAnswers,fill:"hsl(var(--chart-2))"},{name:"Incorrect",value:S.incorrectAnswers,fill:"hsl(var(--destructive))"}]:[],[S]),B=()=>{q(),e.push("/topics")};return R?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-4rem)] text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-primary mb-4"}),(0,s.jsx)("h2",{className:"text-2xl font-headline",children:"Calculating your results..."})]}):S?(0,s.jsxs)("div",{className:"container mx-auto py-10",children:[(0,s.jsx)(y.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,s.jsxs)(d.Zp,{className:"text-center shadow-2xl rounded-2xl mb-8",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(g.A,{className:"mx-auto h-16 w-16 text-yellow-500"}),(0,s.jsx)(d.ZB,{className:"font-headline text-4xl",children:"Quiz Results"})]}),(0,s.jsxs)(d.Wu,{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-2xl",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-bold text-accent",children:[S.score," / ",null==t?void 0:t.questions.length]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Score"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-bold text-accent",children:[S.percentage.toFixed(2),"%"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Percentage"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-bold text-accent",children:[S.accuracy.toFixed(2),"%"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Accuracy"})]})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,s.jsx)(y.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:(0,s.jsxs)(d.Zp,{className:"shadow-lg rounded-2xl",children:[(0,s.jsx)(d.aR,{children:(0,s.jsx)(d.ZB,{className:"font-headline",children:"Answer Breakdown"})}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)(c.u,{width:"100%",height:300,children:(0,s.jsxs)(o.E,{data:Q,layout:"vertical",margin:{top:20,right:30,left:20,bottom:5},children:[(0,s.jsx)(u.d,{strokeDasharray:"3 3"}),(0,s.jsx)(x.W,{type:"number"}),(0,s.jsx)(h.h,{type:"category",dataKey:"name"}),(0,s.jsx)(m.m,{contentStyle:{backgroundColor:"hsl(var(--background))",borderColor:"hsl(var(--border))",borderRadius:"var(--radius)"}}),(0,s.jsx)(p.y,{dataKey:"value",barSize:40,children:Q.map((e,t)=>(0,s.jsx)(f.f,{fill:e.fill},t))})]})})})]})}),(0,s.jsx)(y.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},children:(0,s.jsxs)(d.Zp,{className:"shadow-lg rounded-2xl max-h-[600px] overflow-y-auto",children:[(0,s.jsx)(d.aR,{children:(0,s.jsx)(d.ZB,{className:"font-headline",children:"Review Answers"})}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)("div",{className:"space-y-6",children:S.breakdown.map((e,t)=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-start text-left space-x-3",children:[e.isCorrect?(0,s.jsx)(j.A,{className:"h-5 w-5 text-green-500 mt-1 flex-shrink-0"}):(0,s.jsx)(v.A,{className:"h-5 w-5 text-red-500 mt-1 flex-shrink-0"}),(0,s.jsxs)("p",{className:"font-semibold",children:["Question ",t+1,": ",e.question]})]}),(0,s.jsx)("div",{className:"space-y-2 mt-4 ml-8",children:e.options.map((t,r)=>{let l=r===e.correctIndex,a=r===e.userAnswerIndex;return(0,s.jsx)("div",{className:(0,A.cn)("p-3 border rounded-lg",l?"bg-green-100 border-green-300 dark:bg-green-900/50 dark:border-green-700":"bg-muted/30",a&&!l?"bg-red-100 border-red-300 dark:bg-red-900/50 dark:border-red-700":""),children:(0,s.jsx)("p",{className:(0,A.cn)(l?"text-green-800 dark:text-green-200":"",a&&!l?"text-red-800 dark:text-red-200":""),children:t})},r)})}),e.originalExplanation&&(0,s.jsx)("div",{className:"mt-4 ml-8 p-3 bg-blue-50 border-l-4 border-blue-400 dark:bg-blue-900/30 rounded-r-lg",children:(0,s.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[(0,s.jsx)("span",{className:"font-bold",children:"Rationale:"})," ",e.originalExplanation]})}),t<S.breakdown.length-1&&(0,s.jsx)(k.w,{className:"mt-6"})]},e.questionId))})})]})})]}),(0,s.jsxs)("div",{className:"mt-8 flex justify-center gap-4",children:[(0,s.jsx)(n.$,{onClick:()=>t&&e.push("/quiz/".concat(t.id)),children:"Retake Topic"}),(0,s.jsx)(n.$,{onClick:B,variant:"outline",children:"Choose New Topic"})]})]}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-4rem)] text-center",children:[(0,s.jsx)("h2",{className:"text-2xl font-headline",children:"Could not load results."}),(0,s.jsx)(n.$,{onClick:B,className:"mt-4",children:"Try another quiz"})]})}},8376:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(40157).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},24371:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(40157).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},24655:(e,t,r)=>{Promise.resolve().then(r.bind(r,7341))},29100:(e,t,r)=>{"use strict";r.d(t,{w:()=>o});var s=r(95155),l=r(12115),a=r(63655),i="horizontal",n=["horizontal","vertical"],d=l.forwardRef((e,t)=>{var r;let{decorative:l,orientation:d=i,...c}=e,o=(r=d,n.includes(r))?d:i;return(0,s.jsx)(a.sG.div,{"data-orientation":o,...l?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...c,ref:t})});d.displayName="Separator";var c=r(59434);let o=l.forwardRef((e,t)=>{let{className:r,orientation:l="horizontal",decorative:a=!0,...i}=e;return(0,s.jsx)(d,{ref:t,decorative:a,orientation:l,className:(0,c.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",r),...i})});o.displayName=d.displayName},63655:(e,t,r)=>{"use strict";r.d(t,{hO:()=>d,sG:()=>n});var s=r(12115),l=r(47650),a=r(99708),i=r(95155),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,a.TL)(`Primitive.${t}`),l=s.forwardRef((e,s)=>{let{asChild:l,...a}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(l?r:t,{...a,ref:s})});return l.displayName=`Primitive.${t}`,{...e,[t]:l}},{});function d(e,t){e&&l.flushSync(()=>e.dispatchEvent(t))}},74136:(e,t,r)=>{"use strict";r.d(t,{QuizProvider:()=>c,f:()=>o});var s=r(95155),l=r(12115),a=r(35317),i=r(56104),n=r(49072);let d=(0,l.createContext)(void 0);function c(e){let{children:t}=e,{user:r}=(0,n.A)(),[c,o]=(0,l.useState)(null),[u,x]=(0,l.useState)([]),[h,m]=(0,l.useState)(0),[p,f]=(0,l.useState)(!1),[g,j]=(0,l.useState)([]),[v,y]=(0,l.useState)(0),b=(0,l.useCallback)(async(e,t)=>{if(r&&c){let s=(0,a.H9)(i.db,"users",r.uid,"quizProgress",c.id);await (0,a.BN)(s,{userId:r.uid,topicId:c.id,userAnswers:e,currentQuestionIndex:t,updatedAt:new Date,completed:!1},{merge:!0})}},[r,c]),w=(0,l.useCallback)(async e=>{if(f(!0),o(e),r){let t=(0,a.H9)(i.db,"users",r.uid,"quizProgress",e.id),s=await (0,a.x7)(t);if(s.exists()&&s.data().completed){let s=Array(e.questions.length).fill(null);await (0,a.BN)(t,{userId:r.uid,topicId:e.id,userAnswers:s,currentQuestionIndex:0,updatedAt:new Date,completed:!1},{merge:!0}),x(s),m(0);let l=Array(e.questions.length).fill(!1);l[0]=!0,j(l)}else if(s.exists()){let r=s.data(),l=r.userAnswers||[];if(l.length!==e.questions.length){let r=Array(e.questions.length).fill(null);await (0,a.BN)(t,{userAnswers:r,currentQuestionIndex:0,updatedAt:new Date,completed:!1},{merge:!0}),x(r),m(0);let s=Array(e.questions.length).fill(!1);s[0]=!0,j(s)}else{x(l),m(r.currentQuestionIndex||0);let t=Array(e.questions.length).fill(!1);l.forEach((e,r)=>{null!==e&&(t[r]=!0)}),t[r.currentQuestionIndex||0]=!0,j(t)}}else{x(Array(e.questions.length).fill(null)),m(0);let t=Array(e.questions.length).fill(!1);t[0]=!0,j(t)}}else{x(Array(e.questions.length).fill(null)),m(0);let t=Array(e.questions.length).fill(!1);t[0]=!0,j(t)}},[r]),N=(0,l.useCallback)(()=>{o(null),x([]),m(0),f(!1),j([]),y(0)},[]);return(0,s.jsx)(d.Provider,{value:{topic:c,setTopic:o,userAnswers:u,setUserAnswers:x,currentQuestionIndex:h,setCurrentQuestionIndex:m,quizStarted:p,startQuiz:w,resetQuiz:N,visitedQuestions:g,setVisitedQuestions:j,saveProgress:b,quizDuration:v,setQuizDuration:y},children:t})}function o(){let e=(0,l.useContext)(d);if(void 0===e)throw Error("useQuiz must be used within a QuizProvider");return e}},91467:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(40157).A)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]])}},e=>{e.O(0,[992,811,635,437,660,540,441,964,358],()=>e(e.s=24655)),_N_E=e.O()}]);