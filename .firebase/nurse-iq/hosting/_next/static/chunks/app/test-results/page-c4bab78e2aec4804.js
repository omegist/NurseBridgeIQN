(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{8376:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(40157).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},16438:(e,t,s)=>{"use strict";s.d(t,{TestResultsClient:()=>C});var r=s(95155),l=s(12115),a=s(35695),n=s(80129),i=s(30285),d=s(66695),o=s(83540),c=s(93774),u=s(94754),x=s(96025),h=s(16238),m=s(94517),p=s(20594),f=s(54811),g=s(91467),v=s(8376),j=s(24371),y=s(1978),b=s(49072),w=s(35317),N=s(56104),k=s(59434),A=s(29100);function C(){let e=(0,a.useRouter)(),{test:t,userAnswers:s,resetTest:C}=(0,n.E)(),{user:I,updateUserScore:q}=(0,b.A)(),[E,S]=(0,l.useState)(null),[P,R]=(0,l.useState)(!0);(0,l.useMemo)(()=>{if(!t||!I)return void R(!1);let e=0,r=0,l=0,a=t.questions.map((t,a)=>{let n=s[a],i=n===t.correctIndex;return i?(e++,r++):l++,{questionId:t.id,question:t.text,isCorrect:i,options:t.options,correctIndex:t.correctIndex,userAnswerIndex:n,correctAnswer:t.options[t.correctIndex],userAnswer:null!=n?t.options[n]:null,originalExplanation:t.explanation}}),n=e/t.questions.length*100;S({score:e,percentage:n,correctAnswers:r,incorrectAnswers:l,breakdown:a}),e>0&&q(10*e);let i=(0,w.H9)(N.db,"users",I.uid,"testProgress",t.id);(0,w.BN)(i,{completed:!0,score:e,percentage:n},{merge:!0}).catch(()=>{}),R(!1)},[t,s,I,q]),(0,l.useEffect)(()=>{P||t&&I||e.push("/tests")},[P,t,I,e]);let T=(0,l.useMemo)(()=>E?[{name:"Correct",value:E.correctAnswers,fill:"hsl(var(--chart-2))"},{name:"Incorrect",value:E.incorrectAnswers,fill:"hsl(var(--destructive))"}]:[],[E]),z=()=>{C(),e.push("/tests")};return P?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-4rem)] text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-primary mb-4"}),(0,r.jsx)("h2",{className:"text-2xl font-headline",children:"Calculating your results..."})]}):E&&t?(0,r.jsxs)("div",{className:"container mx-auto py-10",children:[(0,r.jsx)(y.P.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,r.jsxs)(d.Zp,{className:"text-center shadow-2xl rounded-2xl mb-8",children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(g.A,{className:"mx-auto h-16 w-16 text-yellow-500"}),(0,r.jsx)(d.ZB,{className:"font-headline text-4xl",children:"Test Results"})]}),(0,r.jsxs)(d.Wu,{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-2xl",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-bold text-accent",children:[E.score," / ",null==t?void 0:t.questions.length]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Score"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-bold text-accent",children:[E.percentage.toFixed(2),"%"]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Percentage"})]})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsx)(y.P.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:(0,r.jsxs)(d.Zp,{className:"shadow-lg rounded-2xl",children:[(0,r.jsx)(d.aR,{children:(0,r.jsx)(d.ZB,{className:"font-headline",children:"Answer Breakdown"})}),(0,r.jsx)(d.Wu,{children:(0,r.jsx)(o.u,{width:"100%",height:300,children:(0,r.jsxs)(c.E,{data:T,layout:"vertical",margin:{top:20,right:30,left:20,bottom:5},children:[(0,r.jsx)(u.d,{strokeDasharray:"3 3"}),(0,r.jsx)(x.W,{type:"number"}),(0,r.jsx)(h.h,{type:"category",dataKey:"name"}),(0,r.jsx)(m.m,{contentStyle:{backgroundColor:"hsl(var(--background))",borderColor:"hsl(var(--border))",borderRadius:"var(--radius)"}}),(0,r.jsx)(p.y,{dataKey:"value",barSize:40,children:T.map((e,t)=>(0,r.jsx)(f.f,{fill:e.fill},t))})]})})})]})}),(0,r.jsx)(y.P.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.4},children:(0,r.jsxs)(d.Zp,{className:"shadow-lg rounded-2xl max-h-[600px] overflow-y-auto",children:[(0,r.jsx)(d.aR,{children:(0,r.jsx)(d.ZB,{className:"font-headline",children:"Review Answers"})}),(0,r.jsx)(d.Wu,{children:(0,r.jsx)("div",{className:"space-y-6",children:E.breakdown.map((e,t)=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-start text-left space-x-3",children:[e.isCorrect?(0,r.jsx)(v.A,{className:"h-5 w-5 text-green-500 mt-1 flex-shrink-0"}):(0,r.jsx)(j.A,{className:"h-5 w-5 text-red-500 mt-1 flex-shrink-0"}),(0,r.jsxs)("p",{className:"font-semibold",children:["Question ",t+1,": ",e.question]})]}),(0,r.jsx)("div",{className:"space-y-2 mt-4 ml-8",children:e.options.map((t,s)=>{let l=s===e.correctIndex,a=s===e.userAnswerIndex;return(0,r.jsx)("div",{className:(0,k.cn)("p-3 border rounded-lg",l?"bg-green-100 border-green-300 dark:bg-green-900/50 dark:border-green-700":"bg-muted/30",a&&!l?"bg-red-100 border-red-300 dark:bg-red-900/50 dark:border-red-700":""),children:(0,r.jsx)("p",{className:(0,k.cn)("text-sm",l?"text-green-800 dark:text-green-200":"",a&&!l?"text-red-800 dark:text-red-200":""),children:t})},s)})}),e.originalExplanation&&(0,r.jsx)("div",{className:"mt-4 ml-8 p-3 bg-blue-50 border-l-4 border-blue-400 dark:bg-blue-900/30 rounded-r-lg",children:(0,r.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[(0,r.jsx)("span",{className:"font-bold",children:"Rationale:"})," ",e.originalExplanation]})}),t<E.breakdown.length-1&&(0,r.jsx)(A.w,{className:"mt-6"})]},e.questionId))})})]})})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-center gap-4",children:[(0,r.jsx)(i.$,{onClick:()=>t&&e.push("/test/".concat(t.id)),children:"Retake Test"}),(0,r.jsx)(i.$,{onClick:z,variant:"outline",children:"Choose New Test"})]})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-4rem)] text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-headline",children:"Could not load results."}),(0,r.jsx)(i.$,{onClick:z,className:"mt-4",children:"Try another test"})]})}},24371:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(40157).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},29100:(e,t,s)=>{"use strict";s.d(t,{w:()=>c});var r=s(95155),l=s(12115),a=s(63655),n="horizontal",i=["horizontal","vertical"],d=l.forwardRef((e,t)=>{var s;let{decorative:l,orientation:d=n,...o}=e,c=(s=d,i.includes(s))?d:n;return(0,r.jsx)(a.sG.div,{"data-orientation":c,...l?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...o,ref:t})});d.displayName="Separator";var o=s(59434);let c=l.forwardRef((e,t)=>{let{className:s,orientation:l="horizontal",decorative:a=!0,...n}=e;return(0,r.jsx)(d,{ref:t,decorative:a,orientation:l,className:(0,o.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",s),...n})});c.displayName=d.displayName},63655:(e,t,s)=>{"use strict";s.d(t,{hO:()=>d,sG:()=>i});var r=s(12115),l=s(47650),a=s(99708),n=s(95155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let s=(0,a.TL)(`Primitive.${t}`),l=r.forwardRef((e,r)=>{let{asChild:l,...a}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,n.jsx)(l?s:t,{...a,ref:r})});return l.displayName=`Primitive.${t}`,{...e,[t]:l}},{});function d(e,t){e&&l.flushSync(()=>e.dispatchEvent(t))}},80129:(e,t,s)=>{"use strict";s.d(t,{E:()=>c,TestProvider:()=>o});var r=s(95155),l=s(12115),a=s(35317),n=s(56104),i=s(49072);let d=(0,l.createContext)(void 0);function o(e){let{children:t}=e,{user:s}=(0,i.A)(),[o,c]=(0,l.useState)(null),[u,x]=(0,l.useState)([]),[h,m]=(0,l.useState)(0),[p,f]=(0,l.useState)(!1),[g,v]=(0,l.useState)([]),[j,y]=(0,l.useState)(0),b=(0,l.useCallback)(async(e,t)=>{if(s&&o){let r=(0,a.H9)(n.db,"users",s.uid,"testProgress",o.id);await (0,a.BN)(r,{userId:s.uid,testId:o.id,userAnswers:e,currentQuestionIndex:t,updatedAt:new Date,completed:!1},{merge:!0})}},[s,o]),w=(0,l.useCallback)(async e=>{if(f(!0),c(e),s){let t=(0,a.H9)(n.db,"users",s.uid,"testProgress",e.id);try{let s=await (0,a.x7)(t);if(s.exists()&&!s.data().completed){let t=s.data(),r=t.userAnswers||[];x(r),m(t.currentQuestionIndex||0);let l=Array(e.questions.length).fill(!1);r.forEach((e,t)=>{null!==e&&(l[t]=!0)}),l[t.currentQuestionIndex||0]=!0,v(l)}else{let r=Array(e.questions.length).fill(null);x(r),m(0);let l=Array(e.questions.length).fill(!1);l[0]=!0,v(l),s.exists()&&s.data().completed&&await (0,a.BN)(t,{userAnswers:r,currentQuestionIndex:0,completed:!1,updatedAt:new Date},{merge:!0})}}catch(s){console.error("Error loading test progress, starting fresh:",s),x(Array(e.questions.length).fill(null)),m(0);let t=Array(e.questions.length).fill(!1);t[0]=!0,v(t)}}else{x(Array(e.questions.length).fill(null)),m(0);let t=Array(e.questions.length).fill(!1);t[0]=!0,v(t)}},[s]),N=(0,l.useCallback)(()=>{c(null),x([]),m(0),f(!1),v([]),y(0)},[]);return(0,r.jsx)(d.Provider,{value:{test:o,setTest:c,userAnswers:u,setUserAnswers:x,currentQuestionIndex:h,setCurrentQuestionIndex:m,testStarted:p,startTest:w,resetTest:N,visitedQuestions:g,setVisitedQuestions:v,saveProgress:b,testDuration:j,setTestDuration:y},children:t})}function c(){let e=(0,l.useContext)(d);if(void 0===e)throw Error("useTest must be used within a TestProvider");return e}},83520:(e,t,s)=>{Promise.resolve().then(s.bind(s,16438))},91467:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(40157).A)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]])}},e=>{e.O(0,[992,811,635,437,660,540,441,964,358],()=>e(e.s=83520)),_N_E=e.O()}]);